<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        
        <script type="text/javascript" src="assets/graphics.js"></script>

        <script type="text/javascript" src="core/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="core/Barrett.js"></script>
        <script type="text/javascript" src="core/BigInt.js"></script>
        <script type="text/javascript" src="core/RSA.js"></script>
        <script type="text/javascript" src="core/priority_queue.js"></script>
        <script type="text/javascript" src="core/easing.js"></script>
        <script type="text/javascript" src="core/constants.js"></script>
        <script type="text/javascript" src="core/entitysystem.js"></script>
        <script type="text/javascript" src="core/components.js"></script>        
        <script type="text/javascript" src="core/systems.js"></script>
        <script type="text/javascript" src="core/utils.js"></script>
        <script type="text/javascript" src="core/pfx.js"></script>
        <script type="text/javascript" src="core/resources.js"></script>
        <script type="text/javascript" src="core/seedrandom.js"></script>
        
        <script type="text/javascript" src="bbq/components.js"></script>
        <script type="text/javascript" src="bbq/systems.js"></script>
        <script type="text/javascript" src="bbq/gamedata.js"></script>
        <script type="text/javascript" src="bbq/tiles.js"></script>
        <script type="text/javascript" src="bbq/ui.js"></script>        
        <script type="text/javascript" src="bbq/game.js"></script>        
        <script type="text/javascript" src="bbq/map.js"></script>
        <script type="text/javascript" src="bbq/units.js"></script>
        <script type="text/javascript" src="bbq/buildings.js"></script>
        <script type="text/javascript" src="bbq/algorithms.js"></script>
        <script type="text/javascript" src="bbq/commands.js"></script>
        
        <script type="text/javascript">
            boc.constants.API_HOST = 'http://myteststore.cloudfoundry.com';
        	boc.utils.requestApiKey();
        	boc.resources.GraphicsManager.load(bbq.assets.graphics);
        	boc.resources.GraphicsManager.loadFiles([
                'pfx_smoke_small.png',
                'pfx_star_small.png'
        	]);
        </script>
    </head>
    <body>
        <div id="mydiv">
            <canvas id="mycanvas" width="800" height="600"></canvas>
        </div>
        <input type="button" value="End turn"></input>
        <script type="text/javascript">
            var canvas = $('#mycanvas')[0];
            $(canvas).attr('unselectable', 'on')
                     .css('user-select', 'none')
                     .on('selectstart', false);
        	var em = boc.core.Entity_internal.em();
        	var game = null;
        	var gameState = null;
        	boc.utils.getJson(
        		'get/games',
        		{
        		    //gameid: 'game_fusoya_alvin_1361651658196',
        		    //gameid: 'game_suppaduppax_fusoya_1361487350606',
        		    gameid: 'game_fire_brand_SuppaDuppaX_1361908738686',
        		    //gameid: 'game_mark_fusoya_1363935546005',
        			__adminkey : 'BoC1234'
        		},
        		function(data) {
        			if (data && data.status == 'ok') {
        			    var json = data.result[0];
        			    gameState = json;
        				game = new bbq.Game({
        					gameState : json,        					
        					canvas : canvas,
        					entityManager: em,
        					user: {
                                playerid : 'SuppaDuppaX'
        					}
        				});
    					game.start();
        			}
        		} // callback
        	); // getJson
        	$('input').click(function () {
        	    game.endTurn();
        	    game.refresh();
        	});
        </script>
    </body>
</html>