<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <script type="text/javascript" src="core/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="core/Barrett.js"></script>
        <script type="text/javascript" src="core/BigInt.js"></script>
        <script type="text/javascript" src="core/RSA.js"></script>
        <script type="text/javascript" src="core/easing.js"></script>
        <script type="text/javascript" src="core/constants.js"></script>
        <script type="text/javascript" src="core/entitysystem.js"></script>
        <script type="text/javascript" src="core/components.js"></script>        
        <script type="text/javascript" src="core/systems.js"></script>
        <script type="text/javascript" src="core/utils.js"></script>
        <script type="text/javascript" src="core/pfx.js"></script>
        <script type="text/javascript" src="core/resources.js"></script>
        <script type="text/javascript" src="core/seedrandom.js"></script>
        
        <script type="text/javascript" src="bbq/components.js"></script>
        <script type="text/javascript" src="bbq/systems.js"></script>
        <script type="text/javascript" src="bbq/gamedata.js"></script>
        <script type="text/javascript" src="bbq/tiles.js"></script>
        <script type="text/javascript" src="bbq/game.js"></script>        
        <script type="text/javascript" src="bbq/map.js"></script>              
    </head>
    <body>
        <div id="mydiv">
            <canvas id="mycanvas" width="800" height="600"></canvas>
        </div>
        <script type="text/javascript">
            var em = boc.core.Entity_internal.em();
            boc.utils.setEntityManager(em);
            
            var renderSystem = new boc.systems.RenderSystem(em, $('#mycanvas')[0]);
            renderSystem.camera(
                new boc.utils.Camera({
                    xmin: 0,
                    xmax: $('#mycanvas')[0].width,
                    ymin: 0,
                    ymax: $('#mycanvas')[0].height
                })
            );            
            var cameraFollowSystem = new boc.systems.CameraFollowSystem(em);            
            var animationSystem = new boc.systems.AnimationSystem(em);
            var mouseInputSystem = new boc.systems.MouseInputSystem(em, $('#mycanvas')[0]);
            var lifespanSystem = new boc.systems.LifespanSystem(em);
            var panningCameraSystem = new boc.systems.PanningCameraSystem(em, renderSystem.camera());
            panningCameraSystem.bounds({
                xmin: 0,
                ymin: 0,
                xmax: $('#mycanvas').width(),
                ymax: $('#mycanvas').height()
            });
            var parabolaSystem = new bbq.systems.ParabolicTranslationSystem(em);

            var lastFrame = 0;
            var stop = false;
            function loop(now) {
                if (stop) { return; }
                requestAnimFrame(loop);                
                var frameTime = now - lastFrame;
                mouseInputSystem.processTick(frameTime);
                panningCameraSystem.processTick(frameTime);
                animationSystem.processTick(frameTime);
                parabolaSystem.processTick(frameTime);
                cameraFollowSystem.processTick(frameTime);
                renderSystem.processTick(frameTime);
                lifespanSystem.processTick(frameTime);
                lastFrame = now;
            } // loop

            loop(lastFrame);

			var bgentity = new boc.core.Entity();
			bgentity.addComponent(
				new boc.components.Spatial({
					x: 0,
					y: 0,
					width: $('#mycanvas').width(),
					height: $('#mycanvas').height()
				})
			);
			bgentity.addComponent(
				new boc.components.DrawableRect({
					fillStyle : 'white'
				})
			);
			
			var entity = new boc.core.Entity();
			entity.addComponent(
				new boc.components.Spatial({
					x: 100,
					y: 100,
					width: 50,
					height: 50
				})
			);
			entity.addComponent(
				new boc.components.DrawableRect({
					fillStyle : 'blue'
				})
			);
			entity.addComponent(
				new bbq.components.ParabolicTranslationAnimation({
				    dx: 200,
				    dy: 100,
				    duration: 1000,
				    easing : 'easeInOutCubic'
				})
			);
			entity.ParabolicTranslationAnimation.state = boc.constants.ANIMATION_PLAYING;


			var bouncingEnt = new boc.core.Entity();
			bouncingEnt.addComponent(
				new boc.components.Spatial({
				    x: 100,
				    y: 100,
				    width: 50,
				    height: 50
				})
			);

			bouncingEnt.addComponent(new boc.components.DrawableText({
			    text: 'Hello World!!',
			    fillStyle: 'black',
			    font : 'bold 12pt Helvetica'
			}));

			setTimeout(function () {
			    boc.utils.createBouncingText('Hello world!', 50, 50, { font: 'bold 16pt Arial' } );
			}, 500);

			boc.utils.createBlinkingRect(20, 120, 0, 100, 50, { fillStyle: 'rgba(255,0,0,0.5)', lineWidth: 0, easing: 'easeInCubic' });
        	            
        </script>
    </body>
</html>